# پراکسی هوشمند و نمایشگر اشتراک V2Ray

این پروژه یک وب اپلیکیشن کوچک با پایتون و فلسک است که به دیتابیس پنل x-ui/3x-ui متصل شده و به ازای هر کاربر (بر اساس `subId`)، یک لینک اشتراک امن و زیبا با قابلیت نمایش اطلاعات مصرف ایجاد می‌کند.

## ✨ ویژگی‌ها

- **لینک‌های اختصاصی:** برای هر `subId` در دیتابیس، یک صفحه وب مجزا و پویا ایجاد می‌شود.
- **نمایش اطلاعات مصرف:** حجم کل، مصرف شده، باقی‌مانده و تاریخ انقضا را (در صورت وجود) از هدر `Subscription-Userinfo` می‌خواند.
- **نصب تمام اتوماتیک:** با یک اسکریپت `setup.sh`، تمام نیازمندی‌ها از جمله Nginx, Gunicorn و SSL به صورت خودکار نصب و کانفیگ می‌شوند.
- **امنیت با SSL:** به صورت خودکار گواهی SSL رایگان از Let's Encrypt دریافت و تمدید می‌کند.
- **سرعت بالا:** با استفاده از سیستم کش داخلی، از ارسال درخواست‌های تکراری به سرور اصلی جلوگیری کرده و سرعت پاسخ‌دهی را به شدت افزایش می‌دهد.
- **مدیریت با گیت‌هاب:** به راحتی می‌توانید کد را روی گیت‌هاب مدیریت کرده و روی هر سروری اجرا کنید.

## 🚀 پیش‌نیازها

1.  یک **سرور مجازی (VPS)** با سیستم‌عامل **Ubuntu 22.04**.
2.  یک **دامنه یا ساب‌دامنه** که رکورد A آن به آدرس IP سرور شما اشاره می‌کند.
3.  دسترسی به فایل دیتابیس پنل (`x-ui.db`).

## ⚙️ پیکربندی اولیه

**قبل از اجرای اسکریپت نصب**، فایل `app.py` را باز کرده و متغیرهای زیر را در بالای فایل با اطلاعات صحیح خود ویرایش کنید:

- `DB_PATH`: مسیر کامل فایل دیتابیس پنل شما.
- `SERVER_IP`: آدرس دامنه یا IP که لینک‌های اشتراک اصلی روی آن قرار دارند.
- `SUBSCRIPTION_PORT`: پورت ثابتی که لینک‌های اشتراک اصلی از آن سرویس‌دهی می‌شوند.
- `SUBSCRIPTION_PATH`: پیشوند مسیر لینک‌های اشتراک (مثلاً `/subscriptionlink/`).

## 🛠️ نصب و راه‌اندازی

مراحل زیر را روی سرور مجازی خود انجام دهید:

1.  **کلون کردن پروژه از گیت‌هاب (اگر قبلاً روی سرور نبوده):**
    ```bash
    git clone [https://github.com/your-username/your-repo.git](https://github.com/your-username/your-repo.git)
    cd your-repo
    ```

2.  **اجرای اسکریپت نصب:**
    ابتدا به اسکریپت اجازه اجرا بدهید:
    ```bash
    chmod +x setup.sh
    ```
    سپس آن را اجرا کنید:
    ```bash
    ./setup.sh
    ```

3.  **دنبال کردن دستورات اسکریپت:**
    اسکریپت از شما ساب‌دامنه، ایمیل و پورت داخلی اپلیکیشن را خواهد پرسید. پس از وارد کردن اطلاعات، منتظر بمانید تا تمام مراحل به صورت خودکار انجام شود.

پس از پایان، سرویس شما روی آدرس `https://your-subdomain` در دسترس خواهد بود.
